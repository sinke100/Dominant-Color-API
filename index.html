<!DOCTYPE html>
<html>
  <head>
    <title>Dominant Color API</title>
  </head>
  <body style='background-color:bisque; text-align:center;color:black'>
    <h1>Dominant Color API</h1>
    <form id="form" enctype="multipart/form-data">
      <input type="file" name="image" accept="image/*">
      <button type="submit">Get Dominant Color</button>
      <button type="reset">Reset</button>
    </form>
    <div id="result"></div>

    <script>
      const form = document.getElementById('form');
      const result = document.getElementById('result');
        const apiKey = 'iXdEJExfKmW9F4wtxBDUjEc4CWjnQhW2';
      form.addEventListener('submit', (event) => {
        event.preventDefault();

        const formData = new FormData(form);
        const xhr = new XMLHttpRequest();

        xhr.open('POST', 'http://192.168.1.12:5000/dominant-color');
        xhr.setRequestHeader('api_key', apiKey);
        xhr.onload = () => {
          if (xhr.status === 200) {
            const data = JSON.parse(xhr.responseText);
            result.innerHTML = `The dominant color is ${data.hex_code}, and image filesize is ${data.size} kb, and image size is ${data.wh}`;
            document.body.style.backgroundColor = `${data.hex_code}`;
            document.body.style.color = `${data.text}`;
          } else if (xhr.status === 401) {
            result.innerHTML = 'Error: Invalid API key.';
            document.body.style.backgroundColor = 'bisque';
            document.body.style.color = 'black';
          }
          else {
            result.innerHTML = 'An error occurred.';
            document.body.style.backgroundColor = 'bisque';
            document.body.style.color = 'black';
          }
        };
        xhr.send(formData);
      });

      form.addEventListener('reset', (event) => {
        result.innerHTML = '';
        document.body.style.backgroundColor = 'bisque';
        document.body.style.color = 'black';
      });
    </script>
  </body>
</html>
